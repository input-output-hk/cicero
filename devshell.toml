imports = [
  "language.go"
]

[[env]]
name = "DATABASE_URL"
value = "postgres://postgres:@127.0.0.1:5432/cicero?sslmode=disable"

[[commands]]
package = "go"

[[commands]]
package = "dbmate"

[[commands]]
package = "golangci-lint"

[[commands]]
package = "liftbridge-cli"

[[commands]]
package = "liftbridge"

[[commands]]
package = "foreman"

[[commands]]
package = "gouml"

[[commands]]
package = "nomad"

[[commands]]
package = "damon"

[[commands]]
name = "lint"
command = "gocritic check -enableAll ./... && fd -e nix -X nixfmt -c"
help = "Run code linters"

[[commands]]
name = "docs"
command = "swagger generate spec -o swagger.yaml --scan-models"
help = "Generate API documentation"

[[commands]]
name = "docs-serve"
command = "docs && swagger serve --no-open -F=swagger swagger.yaml"
help = "Generate and serve API documentation"

[[commands]]
package = "wfs"
help = "Workflow Evaluator (Nix) (wrapper that reads ./workflows)"

[[commands]]
package = "nomad-dev"
help = "Run Nomad in development mode with Nix driver"

[[commands]]
name = "psqlc"
command = "psql -d \"$DATABASE_URL\" \"$@\""
help = "psql into Cicero DB"

[devshell]
name = "cicero"
packages = [
  "diffutils",
  "go",
  "goimports",
  "gopls",
  "gocode",
  "gcc",
  "sqliteInteractive",
  "postgresql_12",
  "gocritic",
  "fd",
  "nixfmt",
  "go-swagger",
  "grafana-loki",
  "cicero-evaluator-nix",
  "cue",
]
